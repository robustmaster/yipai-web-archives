services:
  yipai-web-archiver:
    build: .
    container_name: yipai-web-archiver
    ports:
      - "127.0.0.1:5010:5010"   # 默认仅开启本地监听以保证安全。如需直通公网，请改为 "5010:5010"
    volumes:
      # 核心数据目录
      - ./data:/app/data
      # 配置文件
      - ./config.py:/app/config.py
      # 代码目录挂载：实现 git pull 后 docker compose restart 即可生效，无需 rebuild
      - ./static:/app/static
      - ./templates:/app/templates
      - ./app.py:/app/app.py
      - ./database.py:/app/database.py
      - ./cleaner.py:/app/cleaner.py
    environment:
      - TZ=Asia/Shanghai
      - FLASK_DEBUG=0           # 关闭调试模式，保证性能与安全

    restart: unless-stopped
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
